# InsightBI データ項目一覧

## データ区分

| 区分 | 説明 | 更新頻度 | インポート方法 |
|------|------|----------|----------------|
| マスタデータ | 組織・KPI定義など基本情報 | 年次/随時 | 設定画面 |
| 予算データ | 通期・月次予算 | 年次 | CSV/設定 |
| 実績データ | 月次KPI実績 | 月次 | CSVインポート |
| 案件データ | パイプライン案件一覧 | 随時 | CSVインポート |

---

## 1. マスタデータ（制度データ）

### 1.1 部署マスタ
| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| id | string | ○ | 部署ID | `sales1` |
| name | string | ○ | 部署名 | `営業1部` |
| target | number | ○ | 通期目標（億円） | `70` |
| confirmedYTD | number | ○ | 確定売上（億円） | `18.5` |

### 1.2 KPI定義マスタ
| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| id | string | ○ | KPI ID | `revenue` |
| name | string | ○ | KPI名称 | `売上高` |
| category | string | ○ | カテゴリ | `収益` |
| unit | string | ○ | 単位 | `億円` |
| isHigherBetter | boolean | ○ | 高いほど良いか | `true` |

**標準KPI一覧:**

| カテゴリ | KPI ID | KPI名称 | 単位 | 方向 |
|----------|--------|---------|------|------|
| 収益 | revenue | 売上高 | 億円 | ↑ |
| 収益 | gross_profit | 粗利益 | 億円 | ↑ |
| 収益 | margin_rate | 粗利率 | % | ↑ |
| 収益 | operating_profit | 営業利益 | 億円 | ↑ |
| 営業 | orders | 受注金額 | 億円 | ↑ |
| 営業 | pipeline | パイプライン | 億円 | ↑ |
| 営業 | new_deals | 新規商談数 | 件 | ↑ |
| 営業 | win_rate | 成約率 | % | ↑ |
| プロジェクト | project_count | 稼働PJ数 | 件 | ↑ |
| プロジェクト | project_margin | PJ平均粗利率 | % | ↑ |
| プロジェクト | red_projects | 赤字PJ数 | 件 | ↓ |
| 人事 | headcount | 社員数 | 名 | ↑ |
| 人事 | sales_headcount | 営業人員 | 名 | ↑ |
| 人事 | turnover_rate | 離職率 | % | ↓ |
| 財務 | cash | 現預金残高 | 億円 | ↑ |
| 財務 | sga | 販管費 | 億円 | ↓ |

### 1.3 パイプラインステージ定義
| ステージ | 名称 | 確度(%) | 説明 |
|----------|------|---------|------|
| A | A案件 | 80% | 内示・ほぼ確定 |
| B | B案件 | 50% | 見積提出・交渉中 |
| C | C案件 | 20% | 提案中・検討中 |
| D | D案件 | 5% | 情報収集・話のみ |

---

## 2. 予算データ（管理データ）

### 2.1 通期予算
| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| kpiId | string | ○ | KPI ID | `revenue` |
| amount | number | ○ | 予算金額 | `200.0` |

### 2.2 月次予算配分
| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| month | number | ○ | 月（1-12） | `4` |
| ratio | number | ○ | 配分率 | `0.075` |

---

## 3. 実績データ（月次データ）

### 3.1 月次KPI実績
**CSVインポートフォーマット:**
```
月,KPI ID,実績,予算
4,revenue,14.2,15.0
4,gross_profit,2.1,2.3
4,margin_rate,14.8,15.0
...
```

| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| month | number | ○ | 月（1-12） | `4` |
| kpiId | string | ○ | KPI ID | `revenue` |
| actual | number | ○ | 実績値 | `14.2` |
| budget | number | ○ | 予算値 | `15.0` |

**自動計算項目:**
- variance: 実績 - 予算
- varianceRate: (実績 - 予算) / 予算 × 100

---

## 4. 案件データ（パイプラインデータ）

### 4.1 パイプライン案件
**CSVインポートフォーマット:**
```
ID,案件名,金額(億),ステージ,受注予定月,顧客名,担当者,部署ID
P001,○○ビル新築工事,8.5,A,10,○○不動産,田中,sales1
P002,△△マンション改修,4.2,B,11,△△管理組合,佐藤,sales1
...
```

| 項目名 | 型 | 必須 | 説明 | 例 |
|--------|-----|------|------|-----|
| id | string | ○ | 案件ID | `P001` |
| name | string | ○ | 案件名 | `○○ビル新築工事` |
| amount | number | ○ | 金額（億円） | `8.5` |
| stage | A/B/C/D | ○ | ステージ | `A` |
| expectedCloseMonth | number | ○ | 受注予定月 | `10` |
| customer | string | - | 顧客名 | `○○不動産` |
| owner | string | - | 担当者 | `田中` |
| departmentId | string | ○ | 部署ID | `sales1` |

**自動計算項目:**
- weightedAmount: 金額 × ステージ確度

---

## 5. データフロー図

```
┌─────────────────────────────────────────────────────────────────┐
│                      インポート元                                │
├─────────────────────────────────────────────────────────────────┤
│  会計システム  →  月次KPI実績（売上・利益・販管費等）            │
│  SFA/CRM      →  パイプライン案件データ                         │
│  人事システム  →  人員・離職率データ                            │
│  PM管理       →  プロジェクト数・粗利率・赤字PJ                  │
└─────────────────────────────────────────────────────────────────┘
                              ↓
                    CSVエクスポート/API
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                    InsightBI インポート                          │
├─────────────────────────────────────────────────────────────────┤
│  月次KPIデータ   →  MonthlyFollowDashboard                      │
│  パイプライン    →  PipelineManagement / 部署別ドリルダウン       │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                      ダッシュボード表示                          │
├─────────────────────────────────────────────────────────────────┤
│  目標達成状況   ← 確定売上 + パイプライン見込み vs 通期目標       │
│  部署別状況    ← 各部署の目標・実績・パイプライン集計            │
│  KPIトレンド   ← 月次推移・予実差異                              │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. インポートスケジュール例

| データ種別 | 更新タイミング | 担当 | ソースシステム |
|------------|---------------|------|----------------|
| 月次KPI実績 | 毎月5営業日 | 経理部 | 会計システム |
| パイプライン | 毎週月曜 | 営業企画 | SFA |
| 人員データ | 毎月1日 | 人事部 | 人事システム |
| PJデータ | 毎月10日 | PMO | PM管理システム |

---

## 7. CSVテンプレート

### 月次KPIデータ
```csv
月,KPI ID,実績,予算
4,revenue,14.2,15.0
4,gross_profit,2.1,2.3
4,margin_rate,14.8,15.0
4,operating_profit,0.8,0.9
4,orders,16.5,16.5
4,pipeline,85.0,90.0
4,new_deals,28,30
4,win_rate,32.0,35.0
4,project_count,125,120
4,project_margin,14.2,15.0
4,red_projects,2,0
4,headcount,142,145
4,sales_headcount,52,55
4,turnover_rate,0.8,0.8
4,cash,28.5,30.0
4,sga,2.8,2.8
```

### パイプラインデータ
```csv
ID,案件名,金額(億),ステージ,受注予定月,顧客名,担当者,部署ID
P001,○○ビル新築工事,8.5,A,10,○○不動産,田中,sales1
P002,△△マンション改修,4.2,A,11,△△管理組合,佐藤,sales1
P003,□□工場増設,6.8,A,12,□□製作所,鈴木,sales2
P004,××商業施設,12.0,B,11,××リテール,伊藤,sales1
P005,▽▽オフィスビル,7.5,B,12,▽▽商事,渡辺,sales2
P006,●●タワー新築,25.0,C,2,●●開発,加藤,sales1
P007,○△複合施設計画,50.0,D,3,○△HD,松本,sales1
```

### 部署マスタ
```csv
部署ID,部署名,通期目標(億),確定売上(億)
sales1,営業1部,70,18.5
sales2,営業2部,65,15.2
sales3,営業3部,65,12.8
```
